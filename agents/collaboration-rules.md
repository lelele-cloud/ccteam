# 智能体协作规则

## 概述

本文档定义了 CCTeam 中智能体之间的协作方式、沟通规范、冲突处理机制和紧急情况处理流程。通过明确的协作规则，确保团队高效运转、问题快速解决。

---

## 1. 协作原则

### 1.1 四大核心原则

#### 职责分明

```
原则：每个智能体只负责自己职责范围内的工作，不越权干预他人职责。

具体要求：
- 按照权限矩阵定义的范围行事
- 对非职责范围的事项提出建议而非决策
- 职责边界不清时，及时与相关角色确认
- 不因紧急情况随意扩展职责（除非获得授权）
```

#### 主动沟通

```
原则：发现问题、风险或阻塞及时通知相关角色，不隐瞒、不拖延。

具体要求：
- 问题发现后 1 小时内通知相关方
- 阻塞性问题立即升级
- 主动同步进度，不等人询问
- 信息透明，全员可见
```

#### 尊重专业

```
原则：尊重其他角色的专业判断，在非自己专业领域保持谦逊。

具体要求：
- 对专业问题听取专家意见
- 提出异议时提供依据而非主观判断
- 技术问题尊重技术角色决策
- 产品问题尊重产品角色决策
```

#### 整体优先

```
原则：个人意见服从整体利益，团队目标高于个人偏好。

具体要求：
- 决策考虑项目整体影响
- 必要时牺牲个人偏好方案
- 接受集体决策，即使与个人意见不同
- 不因个人情绪影响团队协作
```

---

## 2. 角色职责边界

### 2.1 技术负责人 vs 架构师

#### 职责区分

| 维度 | 技术负责人 (TL) | 架构师 (Arch) |
|------|-----------------|---------------|
| **核心关注** | 项目整体技术方向和落地 | 系统架构设计和长期演进 |
| **决策范围** | 技术选型最终决策、代码质量把关 | 架构方案设计、技术标准制定 |
| **时间视角** | 当前迭代、短期目标 | 长期演进、系统可扩展性 |
| **日常工作** | 技术评审、问题协调、进度把控 | 架构设计、方案评审、技术指导 |
| **对外职责** | 代表技术团队对接产品/业务 | 制定技术规范、输出架构文档 |

#### 协作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                   TL vs Arch 协作流程                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 需求来临                                                    │
│     └── TL 评估技术复杂度和影响范围                              │
│          │                                                      │
│          ├── 简单需求 → TL 直接指导工程师实现                    │
│          │                                                      │
│          └── 复杂需求 → 转交 Arch 进行架构设计                   │
│                                                                 │
│  2. 架构设计                                                    │
│     └── Arch 设计架构方案                                       │
│          ↓                                                      │
│     └── TL 评审方案可行性                                       │
│          │                                                      │
│          ├── 通过 → Arch 输出架构文档，TL 组织实施               │
│          │                                                      │
│          └── 不通过 → Arch 调整方案，再次评审                    │
│                                                                 │
│  3. 开发过程                                                    │
│     └── TL 日常把控技术质量                                     │
│     └── Arch 处理架构相关问题、指导重大技术决策                  │
│                                                                 │
│  4. 分歧处理                                                    │
│     └── 架构层面问题：Arch 决策                                 │
│     └── 实施层面问题：TL 决策                                   │
│     └── 交叉问题：共同协商                                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 分歧处理

| 分歧类型 | 主导方 | 处理方式 |
|----------|--------|----------|
| 架构方案选择 | Arch | Arch 提出方案，TL 评估可行性 |
| 技术选型 | TL | TL 最终决策，Arch 提供建议 |
| 代码质量标准 | TL | TL 定义标准，Arch 确认符合架构 |
| 性能优化方向 | Arch | Arch 指导方向，TL 组织实施 |

---

### 2.2 代码审查员 vs 技术负责人

#### 职责区分

| 维度 | 代码审查员 (CR) | 技术负责人 (TL) |
|------|-----------------|-----------------|
| **核心关注** | 代码质量、编码规范、最佳实践 | 技术实现、业务逻辑、整体设计 |
| **决策范围** | 代码是否符合规范、是否可合并 | 技术方案是否合理、是否满足需求 |
| **审查深度** | 详细审查每行代码、每个细节 | 关注关键逻辑和设计模式 |
| **审查重点** | 代码风格、命名、注释、测试覆盖 | 业务逻辑、安全隐患、性能问题 |
| **日常工作** | Code Review、规范推广 | 方案评审、技术指导、团队管理 |

#### 协作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                   CR vs TL 协作流程                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 代码提交                                                    │
│     └── 开发工程师提交 PR                                       │
│                                                                 │
│  2. 代码审查                                                    │
│     └── CR 进行详细审查                                         │
│          │                                                      │
│          ├── 代码规范问题 → CR 直接反馈                         │
│          │                                                      │
│          ├── 设计模式问题 → CR 评估后决定是否升级               │
│          │                                                      │
│          └── 重大设计问题 → 升级给 TL                           │
│                                                                 │
│  3. TL 介入场景                                                 │
│     - 涉及架构调整的改动                                        │
│     - 安全相关的敏感代码                                        │
│     - CR 与开发者意见分歧                                       │
│     - 需要跨团队协调的改动                                      │
│                                                                 │
│  4. 最终审批                                                    │
│     ├── 常规代码 → CR 审批通过即可合并                          │
│     └── 重要代码 → CR + TL 双重审批                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 升级规则

| 问题类型 | CR 处理方式 | 是否升级 TL |
|----------|-------------|-------------|
| 命名不规范 | 直接反馈修改 | 否 |
| 缺少单元测试 | 直接反馈补充 | 否 |
| 设计模式不当 | 评估影响范围后决定 | 视情况 |
| 安全漏洞 | 通知 Sec，升级 TL | 是 |
| 架构层面问题 | 升级 TL 和 Arch | 是 |
| 多次沟通无果 | 升级 TL 协调 | 是 |

---

### 2.3 API工程师 vs 后端工程师

#### 职责区分

| 维度 | API工程师 (API) | 后端工程师 (BE) |
|------|-----------------|-----------------|
| **核心关注** | API 设计、接口规范、文档维护 | API 实现、业务逻辑、服务开发 |
| **输出物** | API 规范文档、接口定义、Mock 数据 | 实现代码、业务逻辑、数据处理 |
| **工作阶段** | 先于开发，设计阶段 | 后于设计，开发阶段 |
| **关注点** | 接口易用性、一致性、向后兼容 | 实现效率、代码质量、性能优化 |
| **对接方** | 前端工程师、外部调用方 | DBA、其他后端服务 |

#### 协作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                   API vs BE 协作流程                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  阶段1: API 设计                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ API工程师:                                               │   │
│  │ 1. 分析需求，识别需要的接口                              │   │
│  │ 2. 设计接口规范（路径、方法、参数、响应）                │   │
│  │ 3. 输出 API 文档（OpenAPI/Swagger）                      │   │
│  │ 4. 提供 Mock 数据供前端联调                              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  阶段2: 设计评审                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 评审参与方: API + FE + BE + TL                          │   │
│  │ 评审内容:                                                │   │
│  │ - FE: 接口是否满足前端需求                               │   │
│  │ - BE: 接口是否可实现、是否合理                           │   │
│  │ - TL: 整体设计是否符合规范                               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  阶段3: 后端实现                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 后端工程师:                                              │   │
│  │ 1. 按照 API 文档实现接口                                 │   │
│  │ 2. 实现业务逻辑和数据处理                                │   │
│  │ 3. 编写接口测试                                          │   │
│  │ 4. 如发现设计问题，与 API 沟通调整                       │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  阶段4: 接口验证                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ API工程师:                                               │   │
│  │ 1. 验证实现与文档一致性                                  │   │
│  │ 2. 更新文档反映实际实现                                  │   │
│  │ 3. 确认接口可用性                                        │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 变更协调

| 场景 | 处理方式 |
|------|----------|
| API 设计阶段调整 | API 更新文档，通知 FE 和 BE |
| BE 实现中发现设计问题 | BE 与 API 协商，API 评估是否调整 |
| FE 反馈接口不满足需求 | FE 与 API 沟通，API 决定是否调整 |
| 接口需要增加字段 | API 评估向后兼容性，更新文档 |
| 接口需要破坏性变更 | API + TL 评审，通知所有调用方 |

---

### 2.4 前端工程师 vs UI设计师

#### 职责区分

| 维度 | 前端工程师 (FE) | UI设计师 (UI) |
|------|-----------------|---------------|
| **核心关注** | 技术实现、交互开发、性能优化 | 视觉效果、设计规范、用户体验 |
| **输出物** | 前端代码、组件库、页面实现 | 设计稿、设计规范、切图资源 |
| **决策范围** | 实现方式、技术方案、代码结构 | 视觉风格、布局设计、配色方案 |
| **对接方** | API工程师、后端工程师 | UX设计师、产品经理 |

#### 交付标准

##### UI 设计师交付物

| 交付物 | 内容要求 | 格式 |
|--------|----------|------|
| 设计稿 | 完整页面设计，包含所有状态 | Figma/Sketch |
| 设计规范 | 颜色、字体、间距、圆角定义 | Markdown/Figma |
| 组件规范 | 按钮、输入框、卡片等组件定义 | Figma 组件库 |
| 切图资源 | 图标、图片等素材 | SVG/PNG@2x |
| 标注文档 | 尺寸、间距、颜色值标注 | Figma 标注 |
| 响应式说明 | 不同屏幕尺寸的适配方案 | 文档说明 |

##### FE 对设计稿的要求

```markdown
## 设计稿检查清单（FE 在开发前确认）

### 完整性检查
- [ ] 所有页面状态完整（默认、悬停、选中、禁用、加载、空状态、错误状态）
- [ ] 移动端/平板端适配方案
- [ ] 边界情况处理（超长文本、空数据等）

### 规范性检查
- [ ] 颜色值使用设计系统定义的变量
- [ ] 字体使用规范字体族
- [ ] 间距使用标准间距系统
- [ ] 组件复用已有组件库

### 可实现性检查
- [ ] 动画效果有明确描述
- [ ] 交互行为有明确定义
- [ ] 无技术上无法实现的设计
```

#### 协作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                   FE vs UI 协作流程                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 设计阶段                                                    │
│     └── UI 完成设计稿                                           │
│          ↓                                                      │
│     └── FE 评审设计稿可实现性                                   │
│          │                                                      │
│          ├── 可实现 → 进入开发                                  │
│          │                                                      │
│          └── 有限制 → 与 UI 协商替代方案                        │
│                                                                 │
│  2. 开发阶段                                                    │
│     └── FE 按设计稿开发                                         │
│          │                                                      │
│          ├── 发现问题 → 及时与 UI 沟通                          │
│          │                                                      │
│          └── 需要调整 → UI 评估后决定                           │
│                                                                 │
│  3. 验收阶段                                                    │
│     └── UI 验收实现效果                                         │
│          │                                                      │
│          ├── 还原度达标 → 通过                                  │
│          │                                                      │
│          └── 需要调整 → FE 修改，再次验收                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 还原度标准

| 级别 | 还原度 | 说明 |
|------|--------|------|
| A级 | >= 95% | 完美还原，肉眼无差别 |
| B级 | >= 90% | 基本还原，有细微差异但不影响体验 |
| C级 | >= 80% | 大体还原，有明显差异需要说明原因 |
| D级 | < 80% | 不合格，需要重新实现 |

**还原度评估维度**：布局准确性、颜色准确性、字体样式、间距尺寸、交互动效

---

## 3. 冲突处理流程

### 3.1 一级冲突：意见不一致

**定义**：角色间对某个具体问题有不同看法，但不涉及根本性分歧。

**处理流程**：

```
┌───────────────────────────────────────────────────────────┐
│                    一级冲突处理流程                        │
├───────────────────────────────────────────────────────────┤
│                                                           │
│  Step 1: 问题明确                                         │
│  └── 双方明确描述各自观点和理由                           │
│                                                           │
│  Step 2: 信息对齐                                         │
│  └── 确认双方基于相同的信息和理解                         │
│                                                           │
│  Step 3: 寻找共识                                         │
│  └── 识别双方意见的共同点                                 │
│                                                           │
│  Step 4: 协商方案                                         │
│  └── 探讨折中方案或优化方案                               │
│                                                           │
│  Step 5: 达成一致                                         │
│  └── 双方确认最终方案                                     │
│                                                           │
│  如无法在 30 分钟内达成一致 → 升级为二级冲突              │
│                                                           │
└───────────────────────────────────────────────────────────┘
```

**记录模板**：

```markdown
## 意见分歧记录

**发生时间**: {{时间}}
**参与角色**: {{角色A}} vs {{角色B}}
**分歧点**: {{简述分歧}}

### 观点A
{{角色A的观点和理由}}

### 观点B
{{角色B的观点和理由}}

### 协商过程
{{协商过程简述}}

### 最终结论
{{达成的一致意见}}
```

---

### 3.2 二级冲突：技术分歧

**定义**：涉及技术方案、实现方式、架构设计等技术层面的分歧。

**处理流程**：

```
┌───────────────────────────────────────────────────────────┐
│                    二级冲突处理流程                        │
├───────────────────────────────────────────────────────────┤
│                                                           │
│  Step 1: 升级通知                                         │
│  └── 通知 TL（技术分歧）或 Arch（架构分歧）               │
│                                                           │
│  Step 2: 方案陈述                                         │
│  └── 各方准备方案文档，包含：                             │
│      - 方案描述                                           │
│      - 优缺点分析                                         │
│      - 风险评估                                           │
│      - 实施成本                                           │
│                                                           │
│  Step 3: 评估讨论                                         │
│  └── TL/Arch 主持，各方陈述观点                           │
│                                                           │
│  Step 4: 裁决                                             │
│  └── TL/Arch 基于技术评估做出决策                         │
│      决策依据：                                           │
│      - 技术可行性                                         │
│      - 维护成本                                           │
│      - 扩展性                                             │
│      - 团队熟悉度                                         │
│                                                           │
│  Step 5: 执行                                             │
│  └── 各方接受决策，按方案执行                             │
│                                                           │
│  如 TL/Arch 无法裁决 → 升级为三级冲突                     │
│                                                           │
└───────────────────────────────────────────────────────────┘
```

**方案对比模板**：

```markdown
## 技术方案对比

### 方案A: {{方案名称}}
**提出人**: {{角色}}

| 维度 | 评估 |
|------|------|
| 技术可行性 | 高/中/低 |
| 实施复杂度 | 高/中/低 |
| 维护成本 | 高/中/低 |
| 扩展性 | 高/中/低 |
| 风险等级 | 高/中/低 |

**优点**:
1. ...
2. ...

**缺点**:
1. ...
2. ...

### 方案B: {{方案名称}}
（同上格式）

### 评估结论
**选定方案**: {{方案X}}
**决策人**: {{TL/Arch}}
**决策理由**: {{理由}}
```

---

### 3.3 三级冲突：业务分歧

**定义**：涉及需求理解、业务逻辑、产品方向等业务层面的分歧，或技术与业务之间的冲突。

**处理流程**：

```
┌───────────────────────────────────────────────────────────┐
│                    三级冲突处理流程                        │
├───────────────────────────────────────────────────────────┤
│                                                           │
│  Step 1: 升级通知                                         │
│  └── 通知 PM（业务分歧）或 PM + TL（技术与业务冲突）       │
│                                                           │
│  Step 2: 问题定义                                         │
│  └── 明确定义分歧的本质：                                 │
│      - 需求理解不一致？                                   │
│      - 业务逻辑有歧义？                                   │
│      - 技术限制与业务需求冲突？                           │
│                                                           │
│  Step 3: 回溯原始需求                                     │
│  └── 查阅 PRD 和用户故事，确认原始需求意图                │
│                                                           │
│  Step 4: 价值评估                                         │
│  └── PM 评估各方案的用户价值和业务价值                    │
│                                                           │
│  Step 5: 联合决策                                         │
│  └── PM + TL 联合决策：                                   │
│      - 纯业务问题：PM 决策                                │
│      - 技术与业务冲突：PM + TL 协商                       │
│                                                           │
│  Step 6: 调整落实                                         │
│  └── 根据决策调整需求/方案，更新相关文档                  │
│                                                           │
│  如仍无法解决 → 暂停相关工作，向上汇报                    │
│                                                           │
└───────────────────────────────────────────────────────────┘
```

**业务分歧记录模板**：

```markdown
## 业务分歧记录

**分歧ID**: BD-{{序号}}
**发生时间**: {{时间}}
**涉及角色**: {{角色列表}}

### 分歧描述
{{详细描述分歧点}}

### 各方观点

**{{角色A}}观点**:
{{观点和理由}}

**{{角色B}}观点**:
{{观点和理由}}

### 原始需求回溯
**PRD 原文**: {{相关PRD内容}}
**用户故事**: {{相关用户故事}}

### 价值评估
| 方案 | 用户价值 | 业务价值 | 实现成本 |
|------|----------|----------|----------|
| 方案A | ... | ... | ... |
| 方案B | ... | ... | ... |

### 最终决策
**决策人**: {{PM/PM+TL}}
**决策结果**: {{决策内容}}
**决策理由**: {{理由}}

### 后续行动
- [ ] 更新 PRD
- [ ] 更新技术方案
- [ ] 通知相关角色
```

---

## 4. 沟通规范

### 4.1 信息同步规范

#### 信息同步表

| 事件 | 通知对象 | 通知方式 | 时效要求 |
|------|----------|----------|----------|
| 阶段开始 | 负责人、评审人、PMO | 主动消息 | 立即 |
| 阶段完成 | 评审人、下游角色、PMO | 主动消息 | 立即 |
| 评审通过 | 负责人、下游角色 | 主动消息 | 立即 |
| 评审不通过 | 负责人、TL | 主动消息 + 详细反馈 | 立即 |
| 发现问题 | 相关角色、TL | 立即通知 | 1小时内 |
| 阻塞问题 | TL、PMO | 立即升级 | 30分钟内 |
| 需求变更 | 所有角色 | 全员通知 | 立即 |
| 技术风险 | TL、Arch、PMO | 立即升级 | 30分钟内 |
| 进度延迟 | PMO、TL | 主动汇报 | 发现后1小时内 |
| 完成里程碑 | 全员 | 全员通知 | 完成后立即 |

#### 通知内容要求

```markdown
## 通知消息格式

**标题**: [{{事件类型}}] {{简短描述}}

**基本信息**:
- 发起人: {{角色}}
- 时间: {{时间}}
- 紧急程度: 普通/重要/紧急

**内容**:
{{事件详细描述}}

**影响范围**:
{{受影响的角色/阶段/功能}}

**需要行动**:
{{需要谁做什么}}

**截止时间**:
{{如有时间要求}}
```

### 4.2 反馈格式规范

#### 评审反馈模板

```markdown
## 评审反馈

**评审人**: {{角色}}
**评审时间**: {{时间}}
**评审对象**: {{文档/代码/设计稿}}
**评审结论**: 通过 / 需修改 / 不通过

### 检查项

| 检查项 | 结果 | 说明 |
|--------|------|------|
| {{检查项1}} | Pass/Fail | {{说明}} |
| {{检查项2}} | Pass/Fail | {{说明}} |

### 问题清单

| 序号 | 严重程度 | 问题描述 | 修改建议 |
|------|----------|----------|----------|
| 1 | 必须修改 | {{问题}} | {{建议}} |
| 2 | 建议修改 | {{问题}} | {{建议}} |
| 3 | 可选优化 | {{问题}} | {{建议}} |

### 总体评价

{{整体评价和建议}}
```

#### 问题反馈模板

```markdown
## 问题反馈

**反馈人**: {{角色}}
**反馈时间**: {{时间}}
**问题类型**: Bug / 需求不清 / 技术阻塞 / 资源不足 / 其他

### 问题描述

{{详细描述问题}}

### 影响范围

- 影响阶段: {{阶段}}
- 影响角色: {{角色}}
- 影响程度: 高/中/低

### 期望处理

**期望响应人**: {{角色}}
**期望响应时间**: {{时间}}
**期望处理方式**: {{描述}}

### 附加信息

{{截图、日志、复现步骤等}}
```

#### 进度汇报模板

```markdown
## 进度汇报

**汇报人**: {{角色}}
**汇报时间**: {{时间}}
**当前阶段**: {{阶段}}

### 完成情况

| 任务 | 计划 | 实际 | 状态 |
|------|------|------|------|
| {{任务1}} | {{计划时间}} | {{实际时间}} | 完成/进行中/延迟 |
| {{任务2}} | {{计划时间}} | {{实际时间}} | 完成/进行中/延迟 |

### 当前进展

{{当前正在做什么}}

### 问题与风险

{{遇到的问题或风险}}

### 下一步计划

{{接下来要做什么}}
```

---

## 5. 紧急情况处理

### 5.1 紧急情况定义

| 级别 | 定义 | 示例 |
|------|------|------|
| **P0 - 致命** | 系统不可用、数据丢失、安全漏洞被利用 | 生产环境宕机、数据库被删除、用户数据泄露 |
| **P1 - 严重** | 核心功能不可用、重大安全漏洞 | 支付功能故障、发现 SQL 注入漏洞 |
| **P2 - 重要** | 重要功能异常、性能严重下降 | 搜索功能出错、页面加载超过 10 秒 |
| **P3 - 一般** | 次要功能异常、用户体验问题 | 某个按钮点击无响应、样式错乱 |

### 5.2 紧急处理流程

```
┌─────────────────────────────────────────────────────────────────┐
│                     紧急情况处理流程                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 发现与上报 (5分钟内)                                        │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ - 任何角色发现紧急情况                                   │   │
│  │ - 立即通知 TL（技术问题）或 PMO（业务问题）              │   │
│  │ - 同时通知 Sec（如涉及安全）                             │   │
│  │ - 简要描述：什么问题、影响范围、发现时间                 │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  2. 影响评估 (10分钟内)                                         │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ TL 快速评估：                                            │   │
│  │ - 问题严重程度（P0/P1/P2/P3）                            │   │
│  │ - 影响范围（多少用户、哪些功能）                         │   │
│  │ - 是否需要立即止损（如下线功能、回滚代码）               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  3. 组建应急小组                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ P0/P1 问题必须组建应急小组：                             │   │
│  │ - 指挥：TL                                               │   │
│  │ - 定位：相关开发工程师                                   │   │
│  │ - 修复：相关开发工程师                                   │   │
│  │ - 部署：DevOps                                           │   │
│  │ - 验证：QA                                               │   │
│  │ - 安全：Sec（如涉及安全问题）                            │   │
│  │ - 协调：PMO                                              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  4. 止损措施                                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 根据情况采取止损措施：                                   │   │
│  │ - 代码回滚                                               │   │
│  │ - 功能下线                                               │   │
│  │ - 服务降级                                               │   │
│  │ - 流量切换                                               │   │
│  │ - 数据修复                                               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  5. 问题修复                                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ - 定位根本原因                                           │   │
│  │ - 开发修复方案                                           │   │
│  │ - 代码审查（可简化但不可省略）                           │   │
│  │ - 测试验证（至少冒烟测试）                               │   │
│  │ - 部署上线                                               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  6. 验证恢复                                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ - 功能验证：QA 确认功能正常                              │   │
│  │ - 监控确认：确认各项指标恢复正常                         │   │
│  │ - 用户反馈：关注用户是否还有问题                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│  7. 事后复盘                                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 24-48小时内完成复盘：                                    │   │
│  │ - 根本原因分析                                           │   │
│  │ - 处理过程回顾                                           │   │
│  │ - 改进措施制定                                           │   │
│  │ - 经验教训总结                                           │   │
│  │ - 预防措施落实                                           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.3 紧急情况权限提升

在紧急情况下，TL 有权进行以下操作（正常情况下需要更多审批）：

| 操作 | 正常流程 | 紧急授权 | 条件 |
|------|----------|----------|------|
| 直接修改生产代码 | CR审查 + TL审批 | TL授权后可直接修改 | P0/P1问题 |
| 跳过完整测试 | QA完整测试 | 只做冒烟测试 | P0问题 |
| 强制回滚 | TL + Arch审批 | TL单独决策 | 生产故障 |
| 暂停服务 | TL + PM审批 | Sec可直接暂停 | 安全漏洞被利用 |
| 跳过评审 | 评审人审批 | TL授权跳过 | 紧急修复 |
| 临时调整角色职责 | 按权限矩阵 | TL临时调整 | 资源不足 |

**重要**：所有紧急操作必须：
1. 记录详细日志
2. 事后补充正常流程
3. 在复盘会议上说明

### 5.4 紧急情况记录模板

```markdown
## 紧急情况报告

**事件ID**: INC-{{序号}}
**事件级别**: P0 / P1 / P2 / P3
**事件状态**: 处理中 / 已恢复 / 已关闭

### 基本信息

| 项目 | 信息 |
|------|------|
| 发现时间 | {{时间}} |
| 发现人 | {{角色}} |
| 恢复时间 | {{时间}} |
| 影响时长 | {{时长}} |
| 影响范围 | {{范围}} |

### 事件描述

{{详细描述发生了什么}}

### 影响评估

- 受影响用户数: {{数量}}
- 受影响功能: {{功能列表}}
- 业务损失: {{如有}}

### 处理时间线

| 时间 | 操作 | 执行人 |
|------|------|--------|
| {{时间}} | {{操作}} | {{角色}} |

### 根本原因

{{分析根本原因}}

### 修复方案

{{如何修复的}}

### 预防措施

| 措施 | 负责人 | 截止时间 |
|------|--------|----------|
| {{措施1}} | {{角色}} | {{时间}} |

### 经验教训

{{总结经验教训}}
```

---

## 6. 日常协作规范

### 6.1 会议规范

| 会议类型 | 频率 | 参与人 | 时长 | 目的 |
|----------|------|--------|------|------|
| 日站会 | 每日 | 全员 | 15分钟 | 同步进度、暴露问题 |
| 评审会 | 按需 | 相关方 | 30-60分钟 | 评审交付物 |
| 技术讨论会 | 按需 | 技术相关 | 30-60分钟 | 讨论技术方案 |
| 周会 | 每周 | 全员 | 60分钟 | 周总结、下周计划 |
| 复盘会 | 阶段结束 | 全员 | 60-90分钟 | 总结经验教训 |

### 6.2 文档规范

| 文档类型 | 存放位置 | 命名规范 | 更新责任人 |
|----------|----------|----------|-----------|
| PRD | docs/ccteam/01-requirements/ | prd-{功能名}.md | PM |
| 技术方案 | docs/ccteam/02-tech-review/ | tech-design-{功能名}.md | TL/Arch |
| 设计稿 | docs/ccteam/03-ui-ux-design/ | design-{页面名}.md | UI/UX |
| API文档 | docs/ccteam/05-api-design/ | api-{模块名}.md | API |
| 测试报告 | docs/ccteam/08-testing/ | test-report-{日期}.md | QA |

### 6.3 代码协作规范

| 规范项 | 要求 |
|--------|------|
| 分支策略 | main/develop/feature/* /hotfix/* |
| 提交信息 | 类型(范围): 描述 |
| PR 要求 | 必须有描述、必须通过 CI、必须有评审 |
| 合并方式 | Squash merge（保持主干整洁） |

---

## 附录：协作规则快速参考

### 遇到问题找谁？

| 问题类型 | 第一联系人 | 升级路径 |
|----------|-----------|----------|
| 需求不清楚 | PM | PM → TL |
| 技术实现问题 | TL | TL → Arch |
| 设计疑问 | UI/UX | UI/UX → PM |
| API问题 | API | API → TL |
| 代码质量问题 | CR | CR → TL |
| 测试问题 | QA | QA → TL |
| 部署问题 | Ops | Ops → TL |
| 安全问题 | Sec | Sec → TL |
| 进度问题 | PMO | PMO → TL |

### 什么时候该升级？

- 30分钟内无法达成一致 → 升级
- 涉及架构变更 → 升级给 Arch
- 涉及安全风险 → 升级给 Sec 和 TL
- 影响项目进度 → 升级给 PMO 和 TL
- 自己无法判断 → 先问 TL

---

*文档版本: v1.0*
*创建日期: 2026-01-29*
*维护人: TL, PMO*
