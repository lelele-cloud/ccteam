# 智能体权限矩阵

## 概述

本文档定义了 CCTeam 中每个智能体角色的权限，包括文档操作权限、阶段操作权限、评审审批权限，以及冲突解决机制。通过明确的权限边界，确保团队协作高效有序。

---

## 1. 权限级别定义

| 代码 | 级别 | 说明 |
|------|------|------|
| **C** | 创建 (Create) | 可以创建新的文档或内容 |
| **R** | 读取 (Read) | 可以查看和阅读内容 |
| **U** | 修改 (Update) | 可以修改已存在的内容 |
| **D** | 删除 (Delete) | 可以删除内容 |
| **V** | 评审 (Review) | 可以对内容进行评审，提出意见 |
| **A** | 审批 (Approve) | 可以最终审批内容，决定通过与否 |

### 权限组合说明

- **CRUD** = 完全操作权限
- **CRUDA** = 完全操作权限 + 最终审批权
- **RV** = 只读 + 评审权
- **RVA** = 只读 + 评审权 + 审批权
- **R** = 只读权限

---

## 2. 文档权限矩阵

### 2.1 角色缩写对照

| 缩写 | 角色 | 中文名称 |
|------|------|----------|
| PM | product-manager | 产品经理 |
| PMO | project-manager | 项目经理 |
| TL | tech-lead | 技术负责人 |
| Arch | architect | 系统架构师 |
| UI | ui-designer | UI设计师 |
| UX | ux-designer | UX设计师 |
| FE | frontend-engineer | 前端工程师 |
| BE | backend-engineer | 后端工程师 |
| API | api-engineer | API工程师 |
| QA | qa-engineer | 测试工程师 |
| Ops | devops-engineer | DevOps工程师 |
| DBA | dba | 数据库管理员 |
| Sec | security-engineer | 安全工程师 |
| Doc | doc-engineer | 技术文档工程师 |
| CR | code-reviewer | 代码审查员 |

### 2.2 核心文档权限矩阵

| 文档类型 | PM | PMO | TL | Arch | UI | UX | FE | BE | API | QA | Ops | DBA | Sec | Doc | CR |
|----------|----|----|----|----|----|----|----|----|-----|----|----|-----|-----|-----|-----|
| **PRD文档** | CRUDA | R | RVA | RV | R | RV | R | R | R | R | R | R | R | R | R |
| **用户故事** | CRUD | R | RV | R | R | RV | R | R | R | RV | R | R | R | R | R |
| **功能清单** | CRUD | RV | RV | R | R | R | R | R | R | R | R | R | R | R | R |
| **技术方案** | R | R | CRUDA | CRUD | R | R | RV | RV | RV | R | RV | RV | RV | R | RV |
| **架构文档** | R | R | RVA | CRUDA | R | R | RV | RV | RV | R | RV | RV | RV | R | R |
| **UI设计稿** | RVA | R | R | R | CRUD | RV | RV | R | R | R | R | R | R | R | R |
| **UX原型图** | RVA | R | R | R | RV | CRUD | RV | R | R | R | R | R | R | R | R |
| **交互规范** | RV | R | R | R | RV | CRUDA | RV | R | R | R | R | R | R | R | R |
| **数据库设计** | R | R | RV | RVA | R | R | R | CRUD | R | R | R | CRUDA | RV | R | R |
| **API文档** | R | R | RVA | RV | R | R | RV | RV | CRUDA | R | R | R | RV | R | R |
| **前端代码** | R | R | RV | R | R | R | CRUD | R | R | RV | R | R | RV | R | RVA |
| **后端代码** | R | R | RV | RV | R | R | R | CRUD | R | RV | R | R | RV | R | RVA |
| **测试计划** | RV | R | RVA | R | R | R | R | R | R | CRUD | R | R | R | R | R |
| **测试用例** | R | R | RV | R | R | R | R | R | R | CRUDA | R | R | R | R | R |
| **测试报告** | RV | RV | RVA | R | R | R | R | R | R | CRUD | R | R | RV | R | R |
| **部署配置** | R | R | RVA | RV | R | R | R | R | R | R | CRUD | R | RVA | R | R |
| **CI/CD脚本** | R | R | RV | R | R | R | R | R | R | R | CRUDA | R | RV | R | R |
| **安全检查单** | R | R | RV | RV | R | R | R | R | R | R | R | R | CRUDA | R | R |
| **用户文档** | RVA | R | R | R | R | RV | R | R | R | R | R | R | R | CRUDA | R |
| **技术文档** | R | R | RVA | RV | R | R | RV | RV | RV | R | RV | RV | R | CRUD | R |
| **项目计划** | RV | CRUDA | RV | R | R | R | R | R | R | R | R | R | R | R | R |
| **周报/日报** | RV | CRUD | RV | R | R | R | R | R | R | R | R | R | R | R | R |

### 2.3 权限矩阵说明

1. **主负责人拥有 CRUD 权限**：每种文档类型都有明确的主负责人，拥有完整的创建、读取、修改、删除权限。

2. **审批权(A)的分配**：
   - PRD/用户故事：技术负责人审批（确认技术可行性）
   - 技术/架构文档：技术负责人或架构师审批
   - 设计稿：产品经理审批（确认符合产品需求）
   - 数据库设计：DBA审批
   - API文档：技术负责人审批
   - 代码：代码审查员审批

3. **评审权(V)的分配**：相关利益方和下游依赖方拥有评审权。

---

## 3. 阶段操作权限

### 3.1 阶段操作权限表

| 操作 | 允许的角色 | 附加条件 |
|------|-----------|----------|
| **启动阶段** | TL, PMO | 前置阶段必须完成（或被跳过） |
| **完成阶段** | 当前阶段主负责人 | 所有必需产出物已生成 |
| **跳过阶段** | TL | 必须说明原因，仅限可跳过阶段 |
| **回退阶段** | TL, Arch | 必须说明原因，创建Issue记录 |
| **强制通过评审** | TL | 必须说明原因，记录特批日志 |
| **暂停项目** | TL, PMO | 重大问题或外部因素导致 |
| **恢复项目** | TL, PMO | 暂停原因已解决 |

### 3.2 可跳过阶段定义

| 阶段 | 可跳过条件 | 审批人 |
|------|-----------|--------|
| UI/UX设计 | 纯后端/API服务项目，无前端界面 | TL |
| 数据库设计 | 无持久化需求的项目（如纯静态网站） | TL + Arch |
| 部署 | 仅本地开发/POC验证阶段 | TL |

### 3.3 阶段操作限制

| 限制 | 说明 |
|------|------|
| 不可跳过的阶段 | 需求分析、技术评审、测试、文档归档 |
| 不可回退的情况 | 已部署上线的代码需通过新迭代修改 |
| 强制通过限制 | 安全测试不通过不可强制通过 |

---

## 4. 评审审批权限

### 4.1 十阶段评审审批矩阵

| 阶段 | 阶段名称 | 主负责人 | 评审人 | 最终审批人 | 评审标准 |
|------|----------|----------|--------|-----------|----------|
| 1 | 需求分析 | PM | TL, Arch | TL | PRD完整性、技术可行性 |
| 2 | 技术评审 | TL, Arch | 全员 | TL + Arch | 架构合理性、技术选型 |
| 3 | UI/UX设计 | UI, UX | PM, FE | PM | 设计稿质量、交互体验 |
| 4 | 数据库设计 | DBA, BE | Arch, BE, Sec | Arch | 表结构、索引、安全 |
| 5 | API设计 | API | FE, BE, TL | TL | 接口规范、完整性 |
| 6 | 前端开发 | FE | CR, TL | CR | 代码质量、规范、性能 |
| 7 | 后端开发 | BE | CR, TL, Sec | CR | 代码质量、安全、性能 |
| 8 | 测试 | QA | TL, PM, Sec | TL | 测试覆盖、质量达标 |
| 9 | 部署上线 | Ops | TL, Sec | TL | 部署配置、监控、安全 |
| 10 | 文档归档 | Doc | PM, TL | PM | 文档完整性、准确性 |

### 4.2 评审通过规则

| 评审类型 | 通过条件 | 适用阶段 |
|----------|----------|----------|
| 单人评审 | 指定审批人通过即可 | 1, 3, 6, 7, 10 |
| 双人评审 | 两位审批人都通过 | 2, 4, 5, 9 |
| 多人评审 | >= 2/3 评审人通过 | 8 (测试阶段) |
| 全员评审 | >= 2/3 核心角色通过 | 2 (技术评审) |

**核心角色定义**：PM, TL, Arch, FE, BE（共5人）

### 4.3 评审驳回处理

| 驳回次数 | 处理方式 |
|----------|----------|
| 第1次驳回 | 原负责人修改后重新提交 |
| 第2次驳回 | TL介入协调，明确修改要点 |
| 第3次驳回 | 召开评审会议，全员讨论解决方案 |
| 多次驳回 | 考虑调整需求范围或技术方案 |

---

## 5. 冲突解决机制

### 5.1 决策优先级链

当角色间对同一事项有不同意见时，按以下优先级链进行决策：

#### 技术决策优先级

```
Arch (架构师) > TL (技术负责人) > BE/FE (工程师)
```

**适用范围**：技术选型、架构设计、性能方案、技术标准

**决策流程**：
1. 工程师提出方案/意见
2. 技术负责人评估可行性
3. 架构师做最终技术决策
4. 如架构师未参与项目，由技术负责人决策

#### 产品决策优先级

```
PM (产品经理) > TL (技术负责人) > 其他角色
```

**适用范围**：需求优先级、功能范围、用户体验、验收标准

**决策流程**：
1. 任何角色提出产品相关意见
2. 产品经理评估用户价值
3. 产品经理做最终产品决策
4. 如涉及技术限制，与TL协商

#### 代码质量决策优先级

```
CR (代码审查员) > TL (技术负责人) > FE/BE (开发工程师)
```

**适用范围**：代码规范、最佳实践、重构建议、代码合并

**决策流程**：
1. 开发工程师提交代码
2. 代码审查员评审
3. 代码审查员决定是否通过
4. 重大分歧升级给技术负责人

#### 安全决策优先级

```
Sec (安全工程师) > TL (技术负责人) > 其他角色
```

**适用范围**：安全漏洞、安全规范、安全审计、数据保护

**决策流程**：
1. 任何角色发现安全问题
2. 安全工程师评估风险等级
3. 安全工程师提出解决方案
4. 高危问题安全工程师有一票否决权

#### 进度决策优先级

```
PMO (项目经理) > TL (技术负责人) > 其他角色
```

**适用范围**：项目排期、资源分配、里程碑调整、风险预警

**决策流程**：
1. 任何角色反馈进度问题
2. 项目经理评估影响
3. 项目经理协调资源和排期
4. 重大进度调整需TL确认

### 5.2 冲突升级机制

```
┌─────────────────────────────────────────────────────────┐
│                     冲突升级路径                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  一级冲突（意见分歧）                                    │
│  └── 当事角色协商解决                                   │
│       │                                                 │
│       ▼ 无法解决                                        │
│  二级冲突（技术/业务分歧）                               │
│  └── 升级到对应领域负责人（TL/PM/Arch）                 │
│       │                                                 │
│       ▼ 无法解决                                        │
│  三级冲突（重大分歧）                                    │
│  └── TL + PM + Arch 联合决策                           │
│       │                                                 │
│       ▼ 仍无法解决                                      │
│  四级冲突（影响项目进行）                                │
│  └── 暂停项目，向上级汇报                               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 5.3 特殊决策场景

| 场景 | 决策人 | 决策依据 |
|------|--------|----------|
| 技术选型争议 | Arch | 技术成熟度、团队熟悉度、长期维护成本 |
| 需求范围争议 | PM | 用户价值、业务优先级、资源投入比 |
| 上线时间争议 | PMO + TL | 质量标准、风险评估、业务紧迫度 |
| 安全与效率冲突 | Sec + TL | 风险等级、修复成本、临时方案可行性 |
| 代码质量与进度冲突 | TL | 技术债务评估、重构时机、最小可用标准 |

---

## 6. 权限例外处理

### 6.1 紧急情况权限提升

在紧急情况下（如线上故障、安全漏洞），以下权限可临时提升：

| 原角色 | 临时权限 | 触发条件 | 审批人 |
|--------|----------|----------|--------|
| BE/FE | 直接修改生产代码 | P0级线上故障 | TL |
| QA | 跳过部分测试 | 紧急hotfix | TL |
| Ops | 强制回滚 | 生产环境严重问题 | TL |
| Sec | 暂停服务 | 发现高危漏洞被利用 | 无需审批 |

### 6.2 权限例外记录

所有权限例外必须记录：

```markdown
## 权限例外记录

**例外ID**: EX-{{序号}}
**申请人**: {{角色}}
**申请时间**: {{时间}}
**例外类型**: 权限提升 / 流程跳过 / 特批通过
**原因说明**: {{详细原因}}
**审批人**: {{审批角色}}
**审批时间**: {{时间}}
**后续处理**: {{是否需要补充流程}}
```

---

## 7. 权限变更管理

### 7.1 权限变更申请

如需调整权限矩阵，需提交变更申请：

1. **申请人**：任何角色
2. **审批人**：TL + PM
3. **评估内容**：
   - 变更必要性
   - 影响范围
   - 安全风险
4. **生效方式**：更新本文档并通知全员

### 7.2 定期权限审计

| 审计项 | 频率 | 负责人 |
|--------|------|--------|
| 权限使用情况 | 每月 | PMO |
| 例外记录审查 | 每周 | TL |
| 权限矩阵有效性 | 每季度 | TL + PM |

---

## 附录：权限矩阵快速参考卡

### 谁可以创建什么？

| 角色 | 可创建的主要文档 |
|------|-----------------|
| PM | PRD、用户故事、功能清单 |
| TL | 技术方案 |
| Arch | 架构文档 |
| UI | UI设计稿 |
| UX | UX原型图、交互规范 |
| DBA | 数据库设计 |
| API | API文档 |
| FE | 前端代码 |
| BE | 后端代码 |
| QA | 测试计划、测试用例、测试报告 |
| Ops | 部署配置、CI/CD脚本 |
| Sec | 安全检查单 |
| Doc | 用户文档、技术文档 |
| PMO | 项目计划、周报 |

### 谁可以审批什么？

| 角色 | 可审批的内容 |
|------|-------------|
| TL | PRD、技术方案、API文档、测试报告、部署配置 |
| Arch | 架构文档、数据库设计 |
| PM | UI/UX设计、用户文档 |
| CR | 前端代码、后端代码 |
| DBA | 数据库设计 |
| Sec | 部署配置、安全检查单 |

---

*文档版本: v1.0*
*创建日期: 2026-01-29*
*维护人: TL, PM*
